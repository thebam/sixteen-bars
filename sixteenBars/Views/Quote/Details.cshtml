@model sixteenBars.Models.QuoteViewModel
@using sixteenBars.Library;

@if (Model.Id > 0)
{
    <h1>
        "@Html.Raw(Model.Text)" -
        @Html.ActionLink(Model.ArtistName, URLClean.Clean(Model.ArtistName), "Artists")
    </h1>




    if (!String.IsNullOrEmpty(Model.Explanation))
    {
        <p>
            <strong>
                Meaning
            </strong>
            <br />
            @Html.DisplayFor(model => model.Explanation)
        </p>
    }
    <div id="trackApp">
        <div ng-controller="AlbumController">

            <div class="row lower-details">
                <div class="col-md-3 albumArt">
                    <img src="@Html.Raw(ViewBag.AlbumImage)" />
                </div>

                <div class="col-md-9">
                    <p>
                        <strong>
                            Album :
                        </strong>


                        @Html.ActionLink(Model.AlbumName, URLClean.Clean(Model.AlbumArtistName) + "/" + URLClean.Clean(Model.AlbumName), "Albums")
                    </p>
                
                    <p>
                        <strong>
                            Artist :
                        </strong>


                        @Html.ActionLink(Model.ArtistName, URLClean.Clean(Model.ArtistName), "Artists")
                    </p>
                
                    <p>
                        <strong>
                            Track :
                        </strong>

                        @Html.ActionLink(Model.TrackName, URLClean.Clean(Model.AlbumName) + "/" + URLClean.Clean(Model.TrackName), "Tracks")
                    </p>
                    @if (ViewBag.PurchaseLinks.Length>0)
                    { 
                    <div>
                        <hr />
                        <h4>Get This Track</h4>
                        @Html.Raw(ViewBag.PurchaseLinks)
                    </div>
                    }
                </div>
            </div>


            @Html.TextBoxFor(model => model.TrackName, new { ng_model = "amzTitle", ng_init = string.Format("amzTitle = '{0}'", Url.Encode(Model.TrackName) + " " + Url.Encode(Model.AlbumName)), style = "display:none;" })
            @Html.TextBoxFor(model => model.AlbumArtistName, new { ng_model = "amzArtistName", ng_init = string.Format("amzArtistName = '{0}'", Url.Encode(Model.AlbumArtistName)), style = "display:none;" })
            <input type="hidden" ng-model="amzType" ng-init="amzType='track'" />
        </div>
    </div>

    <div>
        @Html.ActionLink("Back to List", "Index", "Quote", new { @class = "btn btn-back" })
        @if (User.IsInRole("admin") || User.IsInRole("editor"))
        {
            @: &nbsp;
            @Html.ActionLink("Edit", "Edit", "Quote", new { id = Model.Id }, new { @class = "btn btn-edit" })
            if (User.IsInRole("admin"))
            {
            @: &nbsp;
            @Html.ActionLink("Delete", "Delete", "Quote", new { id = Model.Id }, new { @class = "btn btn-remove" })
            }
        }
    </div>

}
else
{
    <p>No Quote Found.</p>
}

@section Scripts {
    <script src="~/Scripts/sixteenbars-track-app.js"></script>
    <script src="~/Scripts/sixteenbars-autocomplete-functions.js"></script>
    <script src="~/Scripts/sixteenbars-exist-functions.js"></script>
    <script src="~/Scripts/sixteenbars-album-autocomplete.js"></script>
    <script>
        $("body").on("click", ".word", function (e) {
            var txt = "";
            var attr = $(e.target).attr("class");
            if (attr != undefined) {
                txt = attr.replace(" word", "");
            }
            window.location.href = siteURL + "?word=" + txt;
        });




    </script>
}
