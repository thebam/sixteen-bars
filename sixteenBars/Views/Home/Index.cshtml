@model IEnumerable<sixteenBars.Library.Quote>
@using sixteenBars.Library;
@using System.Text.RegularExpressions;
<h1>Random Rap Quotes</h1>
<div class="container quote-blocks">
    @Html.Raw("<div class=\"col-md-4\">")
    @{ var cnt = 0; }
    @foreach (var item in Model)
    {
        
            if (cnt == Math.Ceiling((decimal)Model.Count() / 3))
            {
                cnt = 0;
                @Html.Raw("</div>")
                @Html.Raw("<div class=\"col-md-4\">")
            }
            <div class="quote-block">
            @if (!String.IsNullOrWhiteSpace(item.Artist.Image)) {
                <img src="@item.Artist.Image" class="img-responsive" />
            }else{
                <img src="@item.Track.Album.Image" class="img-responsive" />
            }            
                <div class="quote-info">
                    <span class="quote">@Html.Raw(item.Text)</span><br />
                    @Html.ActionLink(item.Artist.Name, URLClean.Clean(item.Artist.Name), "Artists")<br/>
                    @Html.ActionLink("quote details", URLClean.Clean(item.Artist.Name) + "/" + URLClean.Clean(Regex.Replace(item.Text, "<.*?>", string.Empty)), "Quotes", null, new { @class = "btn btn-standard" })
                </div>
                <div class="clearfix"></div>
            </div>
            cnt++;
        
    }
    @Html.Raw("</div>")

    @if (!Model.Any())
    {
        @Html.Raw("<div class=\"col-md-4\"></div><div class=\"col-md-4\"></div>")
    }
</div>
<div class="container" style="margin-top:15px">
    <div class="col-md-12">
        <img id="init-loading" class="loading" src="~/Images/loading.gif" alt="loading" />
        <a id="btn-more-quotes" class='btn-more-quotes btn btn-inverse' href='quote'>MORE QUOTES</a>
    </div>
</div>
@section Scripts {
    <script src="~/Scripts/sixteenbars-keyword-search.js"></script>
    <script>
        $(document).ready(function () {
            $("#init-loading").hide();
            var queryKeyword = getParameterByName('word');
            if (queryKeyword != undefined) {
                if (queryKeyword.length > 1) {
                    getQuoteByKeyword(queryKeyword);
                }
            } else {
                $("#btn-more-quotes").show();
            }
        });
    </script>
}